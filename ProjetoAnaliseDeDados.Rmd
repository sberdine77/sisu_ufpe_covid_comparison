---
title: "Projeto Análise de dados"
output: html_document
date: "2023-03-21"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = '/Users/savioberdine/Library/CloudStorage/OneDrive-Personal/Documentos/UFRPE/AnaliseDeDados/sisu_ufpe_covid_comparison')
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

## Impactos da pandemia de COVID-19 na entrada de estudantes da UFPE via SISU

Nos dados de 2020, constam os alunos que fizeram ENEM em 2019. Nos dados de 2021, constam os alunos que fizeram ENEM em 2020, já em plena pandemia.

```{r, include=FALSE}
# install.packages("plotly")
library(plotly)
#install.packages("dplyr")
library(ggplot2)
library(ggmap)
library(dplyr)
library(knitr)
library(kableExtra)
```

### Começamos extraindo os dados das respectivas planilhas e colocamo-os em datasets:

```{r}
data_2020 <- read.csv('discentes-ingressos-sisu-2020-ufpe.csv')
df <- apply(data_2020, 2, as.character)
Encoding(df)  <- "UTF-8"
data_2020 <- as.data.frame(df)
#View(data_2020)

data_2021 <- read.csv('discentes-ingressos-sisu-2021-ufpe.csv')
df <- apply(data_2021, 2, as.character)
Encoding(df)  <- "UTF-8"
data_2021 <- as.data.frame(df)
#View(data_2021)
```


### Criamos um dataset com duas novas variáveis: QtdAlunos e PercAlunos, representando a quantidade de alunos e o percentual de alunos agrupados pela escolaridade do pai:

```{r}
students_by_father_education_2020 <- data_2020 %>%
  filter(ESCOLARIDADE_PAI != "") %>%
  group_by(ESCOLARIDADE_PAI) %>%
  summarise(
    QtdAlunos = n(),
    PercAlunos = (n()/nrow(data_2020)) * 100
  )

par(mar = c(5, 10, 5, 5))
barplot(main = "2020 - Estudantes de acordo com a educação do pai", 
        students_by_father_education_2020$PercAlunos, 
        names.arg = students_by_father_education_2020$ESCOLARIDADE_PAI, 
        horiz = TRUE, 
        las = 1,
        cex.names = 0.5)
```

### Perceba que, criando as mesmas variáveis para a escolaridade da mãe e analisando o gráfico, parece haver uma similaridade com os dados da escolaridade do pai:

```{r}
students_by_mother_education_2020 <- data_2020 %>%
  filter(ESCOLARIDADE_MAE != "") %>%
  group_by(ESCOLARIDADE_MAE) %>%
  summarise(
    QtdAlunos = n(),
    PercAlunos = (n()/nrow(data_2020)) * 100
  )

par(mar = c(5, 10, 5, 5))
barplot(main = "2020 - Estudantes de acordo com a educação da mãe", 
        students_by_mother_education_2020$PercAlunos, 
        names.arg = students_by_mother_education_2020$ESCOLARIDADE_MAE, 
        horiz = TRUE, 
        las = 1,
        cex.names = 0.5)
```

### Investigando mais a fundo percebemos que, em 2021, mesmo com percentuais diferentes para cada tipo de escolaridade, os percentuais de alunos ingressantes por escolaridade do pai e mãe permanecem similares entre si:

```{r}
students_by_father_education_2021 <- data_2021 %>%
  filter(ESCOLARIDADE_PAI != "") %>%
  group_by(ESCOLARIDADE_PAI) %>%
  summarise(
    QtdAlunos = n(),
    PercAlunos = (n()/nrow(data_2021)) * 100
  )

students_by_mother_education_2021 <- data_2021 %>%
  filter(ESCOLARIDADE_MAE != "") %>%
  group_by(ESCOLARIDADE_MAE) %>%
  summarise(
    QtdAlunos = n(),
    PercAlunos = (n()/nrow(data_2021)) * 100
  )

par(mar = c(5, 10, 5, 5))
barplot(main = "2021 - Estudantes de acordo com a educação do pai", 
        students_by_father_education_2021$PercAlunos, 
        names.arg = students_by_father_education_2021$ESCOLARIDADE_PAI, 
        horiz = TRUE, 
        las = 1,
        cex.names = 0.5)

par(mar = c(5, 10, 5, 5))
barplot(main = "2021 - Estudantes de acordo com a educação da mãe", 
        students_by_mother_education_2021$PercAlunos, 
        names.arg = students_by_mother_education_2021$ESCOLARIDADE_MAE, 
        horiz = TRUE, 
        las = 1,
        cex.names = 0.5)
```

### Mudança na escolaridade dos pais
<br>
Podemos perceber a partir dos dados que, o nível de escolaridade dos pais dos ingressantes antes a pandemia, é menor do que o do processo seletivo que ocorreu após do COVID-19. Isso pode indicar que, por conta da crise sanitária e posterior dificuldades sociais, houve um favorecimento circunstancial de ingressantes advindos de famílias que já tinham condições educacionais melhores. Para confirmar essa hipótese, devemos realizar uma análise extensiva dos dados dos próximos anos. De qualquer modo, essa tendência já pode ser observada nas tabelas a seguir:

---

#### Na entrada de 2020, antes da pandemia de COVID-19:


```{r, echo=FALSE}
students_by_father_education_2020_sorted <- students_by_father_education_2020[order(-students_by_father_education_2020$PercAlunos),]
kable(students_by_father_education_2020_sorted[1:3, c("ESCOLARIDADE_PAI", "PercAlunos"), drop=FALSE], caption="Níveis de escolaridades do pai com maior percentual de ingressantes")%>%
  kable_styling(full_width = FALSE, position = "left")
```
<br>
```{r, echo=FALSE}
students_by_mother_education_2020_sorted <- students_by_mother_education_2020[order(-students_by_mother_education_2020$PercAlunos),]
kable(students_by_mother_education_2020_sorted[1:3, c("ESCOLARIDADE_MAE", "PercAlunos"), drop=FALSE], caption="Níveis de escolaridade da mãe com maior percentual de ingressantes")%>%
  kable_styling(full_width = FALSE, position = "left")
```

---

#### Na entrada de 2021, após da pandemia de COVID-19:


```{r, echo=FALSE}
students_by_father_education_2021_sorted <- students_by_father_education_2021[order(-students_by_father_education_2021$PercAlunos),]
kable(students_by_father_education_2021_sorted[1:3, c("ESCOLARIDADE_PAI", "PercAlunos"), drop=FALSE], caption="Níveis de escolaridades do pai com maior percentual de ingressantes")%>%
  kable_styling(full_width = FALSE, position = "left")
```
<br>
```{r, echo=FALSE}
students_by_mother_education_2021_sorted <- students_by_mother_education_2021[order(-students_by_mother_education_2021$PercAlunos),]
kable(students_by_mother_education_2021_sorted[1:3, c("ESCOLARIDADE_MAE", "PercAlunos"), drop=FALSE], caption="Níveis de escolaridade da mãe com maior percentual de ingressantes")%>%
  kable_styling(full_width = FALSE, position = "left")
```

### Impactos na diversidade 

```{r, echo=FALSE}
students_by_disability_2020 <- data_2020 %>%
  group_by(DEFICIENCIA) %>%
  summarise(
    PercAlunos = (n()/nrow(data_2020)) * 100
  )

kable(students_by_disability_2020, caption="Percentual de ingressantes com e sem deficiência em 2020")%>%
  kable_styling(full_width = FALSE, position = "left")

students_by_disability_2021 <- data_2021 %>%
  group_by(DEFICIENCIA) %>%
  summarise(
    PercAlunos = (n()/nrow(data_2021)) * 100
  )

kable(students_by_disability_2021, caption="Percentual de ingressantes com e sem deficiência em 2021")%>%
  kable_styling(full_width = FALSE, position = "left")

```
<br>
Analisando os ingressantes por gênero, percebemos que não há mudança significativa entre os anos:

```{r, echo=FALSE}
students_by_gender_2020 <- data_2020 %>%
  group_by(SEXO) %>%
  summarise(
    PercAlunos = (n()/nrow(data_2020)) * 100
  )

kable(students_by_gender_2020, caption="Percentual por sexo em 2020")%>%
  kable_styling(full_width = FALSE, position = "left")

students_by_gender_2021 <- data_2021 %>%
  group_by(SEXO) %>%
  summarise(
    PercAlunos = (n()/nrow(data_2021)) * 100
  )

kable(students_by_gender_2021, caption="Percentual por sexo em 2021")%>%
  kable_styling(full_width = FALSE, position = "left")

```

```{r, echo=FALSE}
idade_em_anos <- as.integer(format(Sys.Date(), "%Y")) - as.integer(data_2021$ANO_NASC)
faixas_etarias <- cut(idade_em_anos, breaks = c(0, 18, 30, 45, Inf), labels = c("0-18", "19-30", "31-45", "46+"))
data <- as.data.frame(faixas_etarias)
students_by_age_group_2021 <- data_2021 %>%
  group_by(cut(as.integer(format(Sys.Date(), "%Y")) - as.integer(data_2021$ANO_NASC), breaks = c(0, 18, 30, 45, Inf), labels = FALSE)) %>%
  summarise(
    PercAlunos = (n()/nrow(data_2021)) * 100
  )
head(students_by_age_group_2021)
```